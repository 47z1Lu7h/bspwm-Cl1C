#!/usr/bin/env bash

DIR="$HOME/.config/polybar/themes"

launch_bar() {
	# Terminate already running bar instances
	killall -q polybar

	# Wait until the processes have been shut down
	while pgrep -u $UID -x polybar >/dev/null; do sleep 1; done

	# Launch
	polybar -q $ZONE -c $DIR/$STYLE.ini & disown

}

purge_last_line() {
	head -n -1 ~/.config/bspwm/bspwmrc > temp.txt; mv temp.txt ~/.config/bspwm/bspwmrc && chmod +x ~/.config/bspwm/bspwmrc
}

echo -ne "\n\t${BLUE}Where would you like the polybar${CYAN}??\n"
echo -ne "\n\t\t${RED}~~>${GREEN}  top \n\t\t${RED}~~>${GREEN}  bottom \n\t\t${RED}~~>${GREEN}  both \n\t\t${RED}\n\n"
read ZONE
sleep 1
if [ $ZONE == "top" ]; then
	echo -ne "\n\t${BLUE}you choose ${LIGHT_BLUE} Top ${CYAN}!!\n"
elif [ $ZONE == "bottom" ]; then
	echo -ne "\n\t${BLUE}you choose ${LIGHT_BLUE} Bottom ${CYAN}!!\n"
elif [ $ZONE == "both" ];then
	echo -ne "\n\t${BLUE}Not implemetened yet ${RED}: (${CYAN}\n\n\n"
	exit 1
else
	echo -ne "\n\t${LIGHT_BLUE}B${RED}Y${CYAN}E"
	exit 1
fi

echo -ne "\n\n\t${BLUE}Choose a ${LIGHT_BLUE}style ${BLUE}from ${CYAN}:"
echo -ne "\n\t\t${RED}~>${GREEN}  47z1\t\t\t\t${RED}~>${GREEN}  simple \n\t\t${RED}~>${GREEN}  pentest_kali\t\t\t\t${RED}~>${GREEN}  plasma\n\n"
read STYLE
sleep 1
if [ $STYLE == 47z1 ]; then
	echo -ne "\n\t${BLUE}You choose ${RED}Pentest ${LIGHT_BLUE}Polybar!!\n"
	launch_bar && purge_last_line && echo "polybar -q $ZONE -c $DIR/$STYLE.ini &" >> ~/.config/bspwm/bspwmrc
	echo -ne "\n\t${BLUE}Done! ${CYAN}: D\n\n"
elif [ $STYLE == simple ]; then
	echo -ne "\n\t${BLUE}You choose ${RED}Pentest ${LIGHT_BLUE}Polybar!!\n"
	launch_bar && purge_last_line && echo "polybar -q $ZONE -c $DIR/$STYLE.ini &" >> ~/.config/bspwm/bspwmrc
	echo -ne "\n\t${BLUE}Done! ${CYAN}: D\n\n"
elif [ $STYLE == pentest_kali ]; then
	echo -ne "\n\t${BLUE}You choose ${RED}Pentest_kali ${LIGHT_BLUE}Polybar!!\n"
	polybar -q $ZONE -c $DIR/$STYLE.ini & purge_last_line && echo "polybar -q $ZONE -c $DIR/kali_$STYLE.ini &" >> ~/.config/bspwm/bspwmrc
	echo -ne "\n\t${BLUE}Done! ${CYAN}: D\n\n"
elif [ $STYLE == plasma ]; then
	echo -ne "\n\t${BLUE}You choose ${RED}Plasma ${LIGHT_BLUE}Polybar!!\n"
	polybar -q left -c $DIR/$STYLE.ini &
	polybar -q rigth -c $DIR/$STYLE.ini &
	echo -ne "\n\t${BLUE}Done! ${CYAN}: D\n\n"

else
	echo -ne "\n\t${LIGHT_BLUE}B${RED}Y${CYAN}E"
fi
