#!/usr/bin/env bash

dir="$HOME/.config/polybar/themes"

launch_bar() {
	# Terminate already running bar instances
	killall -q polybar

	# Wait until the processes have been shut down
	while pgrep -u $UID -x polybar >/dev/null; do sleep 1; done

#	if [[ "$style" == "top" ]]; then
#		dir="$HOME/.config/polybar/themes/top"
#	elif [[ "$style" == "bottom" ]]; then
#		dir="$HOME/.config/polybar/themes/bottom"
#	else

	# Launch the bar
	if [[ "$style" == "47z1" ]]; then
		polybar -q bottom -c "$dir/bottom/47z1.ini" &
	elif [[ "$style" == "pentest" ]]; then
		polybar -q bottom -c "$dir/bottom/pentest.ini" &
	elif [[ "$style" == "simple" ]]; then
		polybar -q bottom -c "$dir/bottom/simple.ini" &
	elif [[ "$style" == "plasma" ]]; then
		polybar -q left  -c "$dir/bottom/plasma.ini" &
		polybar -q right -c "$dir/bottom/plasma.ini" &
	else
		echo -ne "\n\n\tbye!\n"
	fi
}

if [[ "$1" == "--47z1" ]]; then
	style="47z1"
	launch_bar

elif [[ "$1" == "--pentest" ]]; then
	style="pentest"
	launch_bar

elif [[ "$1" == "--simple" ]]; then
	style="simple"
	launch_bar

elif [[ "$1" == "--plasma" ]]; then
	style="plasma"
	launch_bar

else
	cat <<- EOF
	Usage : launch --theme

	Available Themes :
	--47z1 --pentest --simple --plasma
	EOF
fi
